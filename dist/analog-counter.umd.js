!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).AnalogCounter=i()}(this,function(){return function(){function t(t,i,e,s){this.originX=0,this.originY=0,this.scene=t,this.x=i,this.y=e;var h=s||{};this.backgroundColor=null!=h.backgroundColor?s.backgroundColor:16777215,this.fontColor=null!=h.fontColor?s.fontColor:"#000000",this.fontSize=h.fontSize||24,this.padding=h.padding||Math.round(this.fontSize/2),this.digits=h.digits||6,this.height=h.height||2*this.fontSize,this.height>2*this.fontSize&&(this.height=2*this.fontSize),this.width=h.width||this.digits*(this.fontSize+4),this.shade=null!=h.shade?h.shade:.9,this.duration=null!=h.duration?h.duration:1e3,this.oX=this.x-this.originX*this.width,this.oY=this.y-this.originY*this.height,this.init()}var i=t.prototype;return i.getBackground=function(){var t=this.scene.add.graphics();return t.lineStyle(1,0,.9),t.fillStyle(this.backgroundColor,1),t.fillRect(0,0,this.renderTextureWidth,this.renderTextureHeight),t.strokeRect(0,0,this.renderTextureWidth,this.renderTextureHeight),t},i.init=function(){this.gap=Math.ceil(this.padding+this.fontSize/2),this.renderTextureWidth=Math.ceil(this.width/this.digits),this.renderTextureHeight=this.height/2+10*this.gap,this.initMask(),this.initDigitsArray(),this.shade&&this.makeShade(this.shade)},i.initDigitsArray=function(){this.digitsArray=[];for(var t=this.getBackground(),i={fontFamily:"Arial",fontSize:this.fontSize,fontStyle:"bold",color:this.fontColor},e=0;e<this.digits;e++){var s=this.scene.add.renderTexture(this.oX+e*this.renderTextureWidth,this.oY,this.renderTextureWidth,this.renderTextureHeight).setOrigin(0);s.draw(t,0,0);var h=this.scene.add.text(0,0,"9",i).setOrigin(.5,.5);s.draw(h,this.renderTextureWidth/2,this.height/2-this.gap),h.destroy();for(var r=0;r<10;r++){var n=this.scene.add.text(0,0,r.toString(),i).setOrigin(.5,.5);s.draw(n,this.renderTextureWidth/2,this.height/2+r*this.gap),n.destroy()}var o=this.scene.add.text(0,0,"0",i).setOrigin(.5,.5);s.draw(o,this.renderTextureWidth/2,this.renderTextureHeight),o.destroy(),s.setMask(this.mask),this.digitsArray[e]=s}t.destroy()},i.initMask=function(){this.maskShape=this.scene.make.graphics({}).fillStyle(16777215).fillRect(this.oX,this.y,this.width,this.height),this.mask=this.maskShape.createGeometryMask()},i.makeShade=function(t){this.shadeOverlay=this.scene.add.renderTexture(this.oX,this.y,this.width,this.height);var i=this.scene.make.renderTexture({width:this.width,height:this.height/2}).setOrigin(0),e=this.scene.make.graphics({});e.fillStyle(0,t),e.fillRect(0,0,this.width,this.height/2),i.draw(e,0,0),i.setAlpha(1,1,0,0),this.shadeOverlay.draw(i,0,0),i.setAlpha(0,0,1,1),this.shadeOverlay.draw(i,0,this.height/2),i.destroy(),e.destroy()},i.setNumber=function(t){var i=this,e=this.duration,s=t.toString(),h=(s=s.padStart(this.digits,"0")).split(""),r=this.oY;h.forEach(function(t,s){var h=parseInt(t);if(i.digitsArray[s].y!=-h*i.gap)var n=i.scene.tweens.add({targets:i.digitsArray[s],y:r-h*i.gap,duration:e,ease:"Power2",onComplete:function(){n.stop()}})})},i.setOrigin=function(t,i){null==i?(this.originX=t,this.originY=t):(this.originX=t,this.originY=i),this.setPosition(this.x,this.y)},i.setPosition=function(t,i){var e=0,s=0;if(null!=t){var h=t-this.originX*this.width;e=h-this.oX,this.x=t,this.oX=h}if(null!=i){var r=i-this.originY*this.height;s=r-this.oY,this.y=i,this.oY=r}this.digitsArray.forEach(function(t){t.x+=e,t.y+=s}),this.shade&&this.shadeOverlay.setPosition(this.oX,this.oY),this.mask.geometryMask.x+=e,this.mask.geometryMask.y+=s},t}()});
